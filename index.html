<div id="checkoutModal" class="fixed inset-0 z-50 hidden transition-opacity duration-300">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="/* Opcional: cerrarModalCompra() */"></div>
    
    <div class="relative w-full h-full md:h-auto md:max-w-md mx-auto md:my-10 flex flex-col justify-center">
        
        <div class="bg-white w-full h-full md:h-auto md:rounded-3xl shadow-2xl flex flex-col overflow-hidden relative">
            
            <div class="bg-red-500 text-white p-4 pt-6 pb-8 relative">
                <button onclick="cerrarModalCompra()" class="absolute top-4 right-4 text-white/80 hover:text-white">
                    <iconify-icon icon="mingcute:close-line" width="24"></iconify-icon>
                </button>
                
                <div class="flex items-center gap-3 px-2">
                    <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
                        <iconify-icon id="header-icon" icon="solar:card-2-bold-duotone" width="24"></iconify-icon>
                    </div>
                    <div>
                        <h3 id="header-title" class="font-bold text-lg leading-tight">M√©todo de Pago</h3>
                        <p id="header-step" class="text-xs text-red-100 opacity-90">Paso 1 de 5</p>
                    </div>
                </div>
            </div>

            <div class="relative h-1 bg-gray-100 w-full">
                <div id="progress-bar" class="absolute top-0 left-0 h-full bg-red-600 transition-all duration-500" style="width: 20%"></div>
            </div>

            <div class="flex-1 overflow-y-auto p-6 bg-white relative">
                
                <div id="timer-container" class="hidden text-center mb-6">
                    <div class="text-2xl font-bold text-red-500 animate-pulse" id="countdown">15:00</div>
                    <p class="text-xs text-gray-400">Tiempo restante para completar tu compra</p>
                </div>

                <div id="step-1" class="step-content animate-fade-in">
                    <h2 class="text-xl font-bold text-center text-gray-800 mb-6">Selecciona tu m√©todo de pago</h2>
                    
                    <label class="cursor-pointer group">
                        <input type="radio" name="payment_method" value="pago_movil" class="peer hidden" checked>
                        <div class="border-2 border-gray-100 peer-checked:border-red-500 peer-checked:bg-red-50 rounded-2xl p-4 flex items-center gap-4 transition-all hover:border-red-200">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600">
                                <iconify-icon icon="solar:smartphone-2-bold-duotone" width="28"></iconify-icon>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-800">Pago M√≥vil</h4>
                                <p class="text-xs text-gray-500">Pago instant√°neo en Bol√≠vares</p>
                            </div>
                            <div class="w-6 h-6 rounded-full border-2 border-gray-300 peer-checked:border-red-500 peer-checked:bg-red-500 flex items-center justify-center">
                                <iconify-icon icon="mingcute:check-line" class="text-white opacity-0 peer-checked:opacity-100"></iconify-icon>
                            </div>
                        </div>
                    </label>
                    
                    </div>

                <div id="step-2" class="step-content hidden animate-fade-in">
                    <div class="bg-blue-50 border border-blue-100 rounded-xl p-3 mb-6 flex gap-3">
                        <iconify-icon icon="solar:info-circle-bold" class="text-blue-500 text-xl flex-shrink-0 mt-0.5"></iconify-icon>
                        <p class="text-xs text-blue-700 leading-relaxed">
                            Una vez selecciones y presiones <strong>Continuar</strong>, reservaremos tus boletos por unos minutos.
                        </p>
                    </div>

                    <p class="text-sm font-bold text-gray-700 mb-3">Selecci√≥n r√°pida</p>
                    <div class="grid grid-cols-3 gap-3 mb-6">
                        <button onclick="selectQty(1)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="1">1<br><span class="text-[10px] font-normal text-gray-400">Boleto</span></button>
                        <button onclick="selectQty(2)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="2">2<br><span class="text-[10px] font-normal text-gray-400">Boletos</span></button>
                        <button onclick="selectQty(5)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="5">5<br><span class="text-[10px] font-normal text-gray-400">Boletos</span></button>
                        <button onclick="selectQty(10)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="10">10<br><span class="text-[10px] font-normal text-gray-400">Boletos</span></button>
                        <button onclick="selectQty(25)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="25">25<br><span class="text-[10px] font-normal text-gray-400">Boletos</span></button>
                        <button onclick="selectQty(50)" class="qty-btn border border-gray-200 rounded-xl p-3 hover:border-red-500 hover:text-red-500 font-bold transition-all" data-qty="50">50<br><span class="text-[10px] font-normal text-gray-400">Boletos</span></button>
                    </div>

                    <p class="text-sm font-bold text-gray-700 mb-2">Cantidad personalizada</p>
                    <div class="flex items-center gap-3 mb-6">
                        <button onclick="changeQty(-1)" class="w-12 h-12 rounded-xl bg-red-100 text-red-500 flex items-center justify-center hover:bg-red-200 text-xl font-bold">-</button>
                        <input type="number" id="custom-qty" value="1" class="flex-1 text-center font-bold text-xl border-2 border-gray-200 rounded-xl h-12 focus:border-red-500 outline-none" oninput="updateTotal()">
                        <button onclick="changeQty(1)" class="w-12 h-12 rounded-xl bg-red-500 text-white flex items-center justify-center hover:bg-red-600 text-xl font-bold">+</button>
                    </div>

                    <div class="bg-gray-50 rounded-2xl p-4 text-center">
                        <p class="text-xs text-gray-500 mb-1">Total a pagar</p>
                        <h3 class="text-2xl font-black text-gray-900" id="step2-total">Bs. 700.00</h3>
                        <p class="text-[10px] text-gray-400 mt-1" id="step2-detail">1 boleto x Bs. 700.00</p>
                    </div>
                </div>

                <div id="step-3" class="step-content hidden animate-fade-in">
                    <div class="bg-yellow-50 border border-yellow-100 rounded-xl p-3 mb-6 flex gap-3">
                        <iconify-icon icon="solar:shield-warning-bold" class="text-yellow-500 text-xl flex-shrink-0 mt-0.5"></iconify-icon>
                        <div>
                            <p class="text-xs font-bold text-yellow-700">Informaci√≥n importante</p>
                            <p class="text-[10px] text-yellow-600">Aseg√∫rate de ingresar correctamente tus datos para contactarte si ganas.</p>
                        </div>
                    </div>

                    <form id="personal-data-form" class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Nombre y apellido <span class="text-red-500">*</span></label>
                            <input type="text" id="input-name" class="w-full border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 focus:ring-1 focus:ring-red-500 outline-none transition" placeholder="Ej: Juan P√©rez" required>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">C√©dula de identidad <span class="text-red-500">*</span></label>
                            <input type="number" id="input-cedula" class="w-full border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 outline-none transition" placeholder="Ej: 12345678" required>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Tel√©fono con WhatsApp <span class="text-red-500">*</span></label>
                            <div class="flex gap-2">
                                <select class="bg-gray-50 border border-gray-300 rounded-xl px-2 text-sm outline-none">
                                    <option value="58">üáªüá™ +58</option>
                                </select>
                                <input type="tel" id="input-phone" class="flex-1 border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 outline-none transition" placeholder="4121234567" required>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Correo electr√≥nico <span class="text-red-500">*</span></label>
                            <input type="email" id="input-email" class="w-full border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 outline-none transition" placeholder="ejemplo@correo.com" required>
                        </div>
                    </form>
                </div>

                <div id="step-4" class="step-content hidden animate-fade-in">
                    <div class="bg-blue-50 rounded-2xl p-4 mb-6">
                        <div class="flex items-center gap-2 mb-4">
                            <iconify-icon icon="solar:smartphone-2-bold" class="text-blue-600 text-xl"></iconify-icon>
                            <h4 class="font-bold text-gray-800">Pago M√≥vil</h4>
                        </div>
                        
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between items-center pb-2 border-b border-blue-100">
                                <span class="text-gray-500">Banco</span>
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-gray-800">Venezuela (0102)</span>
                                    <button onclick="copiarTexto('0102')" class="text-blue-500 hover:text-blue-700"><iconify-icon icon="solar:copy-bold-duotone"></iconify-icon></button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center pb-2 border-b border-blue-100">
                                <span class="text-gray-500">Tel√©fono</span>
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-gray-800">04243011181</span>
                                    <button onclick="copiarTexto('04243011181')" class="text-blue-500 hover:text-blue-700"><iconify-icon icon="solar:copy-bold-duotone"></iconify-icon></button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center pb-2 border-b border-blue-100">
                                <span class="text-gray-500">C√©dula</span>
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-gray-800">26729223</span>
                                    <button onclick="copiarTexto('26729223')" class="text-blue-500 hover:text-blue-700"><iconify-icon icon="solar:copy-bold-duotone"></iconify-icon></button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center pt-1">
                                <span class="text-gray-500 font-medium">Monto a pagar</span>
                                <div class="flex items-center gap-2">
                                    <span class="font-black text-red-500 text-lg" id="step4-total">Bs. 700.00</span>
                                    <button onclick="copiarMonto()" class="text-red-500 hover:text-red-700"><iconify-icon icon="solar:copy-bold-duotone"></iconify-icon></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="step-5" class="step-content hidden animate-fade-in">
                    <div class="bg-green-50 border border-green-100 rounded-xl p-3 mb-6 flex gap-3">
                        <iconify-icon icon="solar:bill-check-bold" class="text-green-500 text-xl flex-shrink-0 mt-0.5"></iconify-icon>
                        <p class="text-xs text-green-700 leading-relaxed">
                            Ingresa los datos del pago y sube el comprobante para verificar tu transacci√≥n.
                        </p>
                    </div>

                    <form id="payment-proof-form" class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Fecha del pago</label>
                            <input type="date" class="w-full border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 outline-none" value="2025-11-29">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Referencia completa (√öltimos 6 d√≠gitos)</label>
                            <input type="number" class="w-full border border-gray-300 rounded-xl p-3 text-sm focus:border-red-500 outline-none" placeholder="Ej: 123456" required>
                            <p class="text-[10px] text-gray-400 mt-1">Esta referencia la genera tu banco al hacer el pago</p>
                        </div>
                        
                        <div>
                            <label class="block text-xs font-bold text-gray-700 mb-1">Comprobante de pago <span class="text-red-500">*</span></label>
                            <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-gray-50 transition cursor-pointer relative">
                                <input type="file" class="absolute inset-0 opacity-0 cursor-pointer" accept="image/*" onchange="previewImage(this)">
                                <div id="upload-placeholder">
                                    <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-400">
                                        <iconify-icon icon="solar:cloud-upload-bold-duotone" width="24"></iconify-icon>
                                    </div>
                                    <p class="text-xs text-gray-500 font-medium">Arrastra tu comprobante aqu√≠</p>
                                    <p class="text-[10px] text-red-500 mt-1 font-bold">o haz clic para seleccionar</p>
                                </div>
                                <div id="file-preview" class="hidden">
                                    <p class="text-sm font-bold text-green-600 mb-2">¬°Imagen cargada!</p>
                                    <img id="preview-img" class="h-20 mx-auto rounded-lg shadow-sm object-cover">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                 <div id="step-success" class="step-content hidden animate-fade-in text-center py-4">
                    <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce">
                        <iconify-icon icon="solar:check-circle-bold" class="text-blue-500 text-5xl"></iconify-icon>
                    </div>
                    <h2 class="text-2xl font-black text-gray-800 mb-2">¬°Todo Listo!</h2>
                    <p class="text-xs text-gray-500 mb-6 leading-relaxed px-4">
                        Tu compra est√° pendiente. Nuestro equipo revisar√° el comprobante en las pr√≥ximas 24 horas.
                    </p>

                    <div class="bg-gray-50 rounded-2xl p-4 text-left mb-6 shadow-sm border border-gray-100">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center gap-2">
                                <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600">
                                    <iconify-icon icon="solar:clock-circle-bold" width="16"></iconify-icon>
                                </div>
                                <div>
                                    <p class="text-[10px] text-gray-400 font-bold uppercase">Orden</p>
                                    <p class="text-sm font-bold text-gray-800">#014593</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">Total</p>
                                <p class="text-sm font-black text-gray-800" id="success-total">Bs. 700.00</p>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3">
                            <p class="text-xs font-bold text-gray-700 mb-2">Boletos Asignados:</p>
                            <div class="flex flex-wrap gap-2" id="assigned-tickets">
                                <span class="bg-green-500 text-white text-xs font-bold px-2 py-1 rounded">3378</span>
                                <span class="bg-green-500 text-white text-xs font-bold px-2 py-1 rounded">5425</span>
                            </div>
                        </div>
                    </div>
                 </div>

            </div>

            <div id="modal-footer" class="p-4 border-t border-gray-100 bg-gray-50 flex justify-between items-center relative z-10">
                <button id="btn-back" onclick="prevStep()" class="px-4 py-3 rounded-xl text-gray-500 font-bold hover:bg-gray-200 transition text-sm flex items-center gap-1 disabled:opacity-50" disabled>
                    <iconify-icon icon="solar:arrow-left-linear"></iconify-icon> Volver
                </button>
                
                <button id="btn-next" onclick="nextStep()" class="px-8 py-3 bg-red-500 hover:bg-red-600 text-white rounded-xl font-bold shadow-lg shadow-red-200 transition text-sm flex items-center gap-2">
                    Continuar <iconify-icon icon="solar:arrow-right-bold"></iconify-icon>
                </button>
            </div>

        </div>
    </div>
</div>
